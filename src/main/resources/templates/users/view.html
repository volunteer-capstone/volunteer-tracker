<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
	<th:block th:replace="fragments/header :: my-header(${user.getUsername()+'''s Profile'})" />
</head>
<body>
<th:block th:replace="fragments/navbar :: bulma-navbar" />

<h3 th:if="${user.id} == ${userId}">This is your profile: &emsp;<a th:href="@{/profile/edit}">Edit</a></h3>
<h3 th:unless="${user.id} == ${userId}" th:text="'This is '+${user.getUsername()}+'\'s profile: '"></h3>
<p>Name: 						<span th:text="${user.getFirstName()}"></span> <span th:text="${user.getLastName()}"></span></p>
<p>Username: 					<span th:text="${user.getUsername()}"></span></p>
<p>Email: 						<span th:text="${user.getEmail()}"></span></p>
<p>Phone Number: 				<span th:text="${user.getPhoneNumber()}"></span></p>
<p>Number of Hours Volunteered: <span th:text="${user.getHours()}"></span></p>
<p>Number of Hours Planned: 	<span th:text="${user.addHours()}"></span></p>
<p th:if="${user.isOrganizer()}"><strong>Organizer</strong></p>
<p><a class="pastEvents">Past Events</a>&emsp;<a class="plannedEvents">Planned Events</a>&emsp;<a th:if="${user.isOrganizer()}" class="pastEventsCreated">Past Events Created</a>&emsp;<a th:if="${user.isOrganizer()}" class="plannedEventsCreated">Planned Events Created</a></p>
<hr/>
<h4>Events:</h4>
<div th:each="event: ${user.getUserEvents()}" class="pastEventDiv">
	<div th:if="*{event.getStart().before(execInfo.now)}">
	<br/>
		<p th:text="*{event.title}"></p>
		<div th:each="pos: ${user.getUserPositionTitlesByEventId(event.getId())}">
			<p th:if="*{pos.start.before(execInfo.now)}">Position has ended</p>
			<p th:unless="*{pos.start.before(execInfo.now)}">Starts in: </p>
			<p th:text="'Name: ' + *{pos.title} + ' Start: ' + *{pos.start} + ' End: ' + *{pos.end}"></p>
		</div>
		<p th:if="(${user.id} == ${userId}) and (${user.isOrganizer()} == true)"><a>Email all volunteers</a>&emsp;<a>Text all volunteers</a>&emsp;<a>Approve hours</a></p>
		<hr/>
	</div>
</div>

<div th:each="event: ${user.getUserEvents()}" class="plannedEventDiv" style="display: none">
	<div th:if="*{event.getStart().after(execInfo.now)}">
	<br/>
		<p th:text="*{event.title}"></p>
		<p>~These are the planned events~</p>
		<div th:each="pos: ${user.getUserPositionTitlesByEventId(event.getId())}">
			<p th:if="*{pos.start.before(execInfo.now)}">Position has ended</p>
			<p th:unless="*{pos.start.before(execInfo.now)}">Starts in: </p>
			<p th:text="'Name: ' + *{pos.title} + ' Start: ' + *{pos.start} + ' End: ' + *{pos.end}"></p>
		</div>
		<hr/>
	</div>
</div>

<div th:each="event: ${user.getEvents()}" class="pastCreatedEventDiv" style="display: none">
	<div th:if="*{event.getStart().before(execInfo.now)}">
		<br/>
		<p>~Created event (ended)~</p>
		<p th:text="*{event.title}"></p>
		<div th:each="pos: ${user.getUserPositionTitlesByEventId(event.getId())}">
			<p th:if="*{pos.start.before(execInfo.now)}">Position has ended</p>
			<p th:unless="*{pos.start.before(execInfo.now)}">Starts in: </p>
			<p th:text="'Name: ' + *{pos.title} + ' Start: ' + *{pos.start} + ' End: ' + *{pos.end}"></p>
		</div>
		<hr/>
	</div>
</div>

<div th:each="event: ${user.getEvents()}" class="plannedCreatedEventDiv" style="display: none">
	<div th:if="*{event.getStart().after(execInfo.now)}">
		<br/>
		<p>~Created event (planned)~</p>
		<p th:text="*{event.title}"></p>
		<div th:each="pos: ${user.getUserPositionTitlesByEventId(event.getId())}">
			<p th:if="*{pos.start.before(execInfo.now)}">Position has ended</p>
			<p th:unless="*{pos.start.before(execInfo.now)}">Starts in: </p>
			<p th:text="'Name: ' + *{pos.title} + ' Start: ' + *{pos.start} + ' End: ' + *{pos.end}"></p>
		</div>
		<hr/>
	</div>
</div>
</body>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>
	$('.pastEvents').on('click', function () {
        $('.pastEventDiv').css('display', 'inline');
        $('.plannedEventDiv').css('display', 'none');
        $('.plannedCreatedEventDiv').css('display', 'none');
        $('.pastCreatedEventDiv').css('display', 'none');
    });
    $('.plannedEvents').on('click', function () {
        $('.pastEventDiv').css('display', 'none');
        $('.plannedEventDiv').css('display', 'inline');
        $('.plannedCreatedEventDiv').css('display', 'none');
        $('.pastCreatedEventDiv').css('display', 'none');
    });
    $('.plannedEventsCreated').on('click', function () {
        $('.pastEventDiv').css('display', 'none');
        $('.plannedEventDiv').css('display', 'none');
        $('.plannedCreatedEventDiv').css('display', 'inline');
        $('.pastCreatedEventDiv').css('display', 'none');
    });
    $('.pastEventsCreated').on('click', function () {
        $('.pastEventDiv').css('display', 'none');
        $('.plannedEventDiv').css('display', 'none');
        $('.plannedCreatedEventDiv').css('display', 'none');
        $('.pastCreatedEventDiv').css('display', 'inline');
    });
</script>
</html>
